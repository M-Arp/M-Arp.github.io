<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL Mock Draft Builder</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: space-around;
            margin: 20px;
        }
        .column {
            width: 30%;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: #f9f9f9;
        }
        h2 {
            text-align: center;
        }
        .prospect, .team, .drafted {
            padding: 10px;
            margin: 5px 0;
            background-color: #e0e0e0;
            cursor: pointer;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .drafted {
            background-color: #f0f0f0;
            text-decoration: line-through;
        }
        .filter {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="column">
        <h2>Player Pool</h2>
        <input id="filterInput" class="filter" type="text" placeholder="Filter by position">
        <div id="players"></div>
    </div>

    <div class="column">
        <h2>Draft Teams</h2>
        <div id="teams"></div>
    </div>

    <div class="column">
        <h2>Draft Results</h2>
        <div id="draftResults"></div>
        <br>
        <label for="numRounds">Number of Draft Rounds:</label>
        <input type="number" id="numRounds" min="1" value="3">
        <button id="updateRounds">Update Draft Rounds</button>
    </div>

    <script>
        const playersSheetId = 'YOUR_PLAYERS_SHEET_ID'; // Replace with your Players Google Sheet ID
        const teamsSheetId = 'YOUR_TEAMS_SHEET_ID'; // Replace with your Teams Google Sheet ID

        const playersUrl = `https://docs.google.com/spreadsheets/d/${playersSheetId}/gviz/tq?tqx=out:json`;
        const teamsUrl = `https://docs.google.com/spreadsheets/d/${teamsSheetId}/gviz/tq?tqx=out:json`;

        let players = [];
        let teams = [];

        // Fetch players
        fetch(playersUrl)
            .then(response => response.text())
            .then(data => {
                const jsonData = JSON.parse(data.substr(47).slice(0, -2));
                players = jsonData.table.rows.map(row => ({
                    name: row.c[0]?.v,
                    position: row.c[1]?.v,
                    school: row.c[2]?.v,
                    ranking: row.c[3]?.v
                }));
                displayPlayers(players);
            })
            .catch(error => console.error('Error fetching player data:', error));

        // Fetch teams
        fetch(teamsUrl)
            .then(response => response.text())
            .then(data => {
                const jsonData = JSON.parse(data.substr(47).slice(0, -2));
                teams = jsonData.table.rows.map(row => ({
                    name: row.c[0]?.v,
                    logo: row.c[1]?.v,
                    draftOrder: row.c[2]?.v
                }));
                displayTeams(teams);
            })
            .catch(error => console.error('Error fetching team data:', error));

        function displayPlayers(players) {
            const playersContainer = document.getElementById('players');
            playersContainer.innerHTML = ''; // Clear existing players
            players.forEach(player => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'prospect';
                playerDiv.textContent = `${player.name} (${player.position}) - ${player.school} (Rank: ${player.ranking})`;
                playerDiv.onclick = () => assignPlayerToDraft(player);
                playersContainer.appendChild(playerDiv);
            });
        }

        function displayTeams(teams) {
            const teamsContainer = document.getElementById('teams');
            teamsContainer.innerHTML = ''; // Clear existing teams
            teams.forEach((team, index) => {
                const teamDiv = document.createElement('div');
                teamDiv.className = 'team';
                teamDiv.innerHTML = `${team.name} <img src="${team.logo}" alt="${team.name}" width="30">`;

                // Enable team name editing
                const editButton = document.createElement('button');
                editButton.textContent = "Edit Team Name";
                editButton.onclick = () => editTeamName(team, teamDiv);
                
                teamDiv.appendChild(editButton);
                teamsContainer.appendChild(teamDiv);
            });
        }

        function filterPlayersByPosition(position) {
            const filteredPlayers = players.filter(player => player.position.toLowerCase().includes(position.toLowerCase()));
            displayPlayers(filteredPlayers);
        }

        document.getElementById('filterInput').addEventListener('input', (e) => {
            filterPlayersByPosition(e.target.value);
        });

        function assignPlayerToDraft(player) {
            const selectedTeam = prompt("Enter team name for this pick:");
            if (selectedTeam) {
                const draftEntry = document.createElement('div');
                draftEntry.textContent = `${player.name} assigned to ${selectedTeam}`;
                draftEntry.className = 'drafted';
                document.getElementById('draftResults').appendChild(draftEntry);
            }
        }

        function editTeamName(team, teamDiv) {
            const input = document.createElement('input');
            input.type = 'text';
            input.value = team.name;

            // On focus out or enter, save the new team name
            input.addEventListener('blur', () => saveTeamName(team, input, teamDiv));
            input.addEventListener('keypress', function (event) {
                if (event.key === 'Enter') {
                    saveTeamName(team, input, teamDiv);
                }
            });

            teamDiv.textContent = ''; // Clear existing content
            teamDiv.appendChild(input);
            input.focus();
        }

        function saveTeamName(team, input, teamDiv) {
            team.name = input.value; // Update the team's name
            displayTeams(teams); // Refresh team display with updated names
        }

        // Update number of draft rounds
        document.getElementById('updateRounds').addEventListener('click', () => {
            const numRounds = document.getElementById('numRounds').value;
            console.log(`Number of Draft Rounds: ${numRounds}`);
            // Here you can handle draft round updates logic if needed
        });
    </script>
</body>
</html>
